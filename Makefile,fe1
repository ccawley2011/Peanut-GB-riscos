# Project:   peanut


# Toolflags:
CCflags = -c -depend !Depend -IC:,OSLib: -throwback -Otime
C++flags = -c -depend !Depend -IC:,OSLib: -throwback -Otime
Linkflags = -aif -c++ -o $@
ObjAsmflags = -throwback -NoCache -depend !Depend
CMHGflags = 
LibFileflags = -c -o $@
Squeezeflags = -o $@
ModSqzflags = -o $@


# Final targets:
@.!PeanutGB.!RunImage:   @.o.main @.o.emu @.o.gui @.o.msgs @.o.copyasm
        Link $(Linkflags) @.o.main @.o.emu @.o.gui @.o.msgs @.o.copyasm C:o.stubs OSLib:o.OSLib32
        Squeeze $(Squeezeflags) $@

@.bench:   @.o.bench
        Link $(Linkflags) @.o.bench C:o.stubs
        Squeeze $(Squeezeflags) $@


# User-editable dependencies:

# Static dependencies:
.SUFFIXES: .c .i .o .s

.c.o:
        CC $(CCflags) -o $@ $<
o.copyasm: i.copyasm
        ObjAsm $(ObjAsmflags) -o $@ $<
i.copyasm: s.copyasm
        CC $(CCflags) -E $< > $@

.INIT:
        @CDir i
        @CDir o

clean:
        X Delete !PeanutGB.!RunImage
        X Delete bench
        X Wipe i FR~C~V
        X Wipe o FR~C~V


# Dynamic dependencies:
